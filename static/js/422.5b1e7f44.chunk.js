"use strict";(self.webpackChunkaaa_sd_fyp=self.webpackChunkaaa_sd_fyp||[]).push([[422],{4422:(e,r,s)=>{s.r(r),s.d(r,{default:()=>n});var a=s(5043),i=s(6767),t=s(184),o=s(2115),l=s(579);const n=()=>{const[e,r]=(0,a.useState)(0),[n,c]=(0,a.useState)(0),[d,m]=(0,a.useState)(""),[v,u]=(0,a.useState)(""),[h,p]=(0,a.useState)(null),[g,x]=(0,a.useState)({}),[j,N]=(0,a.useState)([]),[f,b]=(0,a.useState)(""),[w,S]=(0,a.useState)(!1),[y,C]=(0,a.useState)(!1),[k,R]=(0,a.useState)(!0),[P,E]=(0,a.useState)(""),[F,L]=(0,a.useState)(""),[O,_]=(0,a.useState)(""),G={1:"Plumbing Services",2:"Electrical Work",3:"Food Catering",4:"Home Painting",5:"Transport Services",6:"Home Cleaning",7:"Gardening & Lawn",8:"Home Repair",9:"Locksmith Services",10:"Online Courses",11:"Food Delivery"},T=(0,i.Zp)();JSON.parse(localStorage.getItem("currentUser")||"{}");(0,a.useEffect)((()=>{try{s.e(18).then(s.bind(s,7018)).then((e=>{const r=e.default;x(r)})).catch((e=>{console.error("Error loading service providers:",e),E("Failed to load service providers. Please try again later.")}))}catch(e){E("Failed to load service providers. Please try again later."),console.error("Error loading service providers:",e)}finally{R(!1)}}),[]),(0,a.useEffect)((()=>{if(v&&g[v]){const e=g[v].filter((e=>e.name.toLowerCase().includes(f.toLowerCase())));N(e)}}),[v,f,g]);return(0,l.jsxs)("div",{className:"review-page",children:[(0,l.jsxs)("button",{className:"back-button",onClick:()=>T(-1),children:[(0,l.jsx)(t.QVr,{})," Back"]}),(0,l.jsxs)("div",{className:"review-container",children:[(0,l.jsx)("h1",{children:"Rate & Review"}),(0,l.jsx)("p",{className:"subtitle",children:"Share your experience with our service providers"}),P&&(0,l.jsx)("div",{className:"error-message",children:P}),F&&(0,l.jsx)("div",{className:"success-message",children:F}),(0,l.jsxs)("form",{onSubmit:async s=>{if(s.preventDefault(),E(""),L(""),!O.trim())return void o.oR.error("Please enter your name.");if(d.length<45)return void o.oR.error("Review must be at least 45 characters long.");if(0===e)return void o.oR.error("Please select a rating.");if(!h)return void o.oR.error("Please select a service provider.");R(!0);const a={reviewerName:O.trim(),providerId:h.id||h._id,providerName:h.name,providerImage:h.image,providerCategory:G[v]||"General",rating:e,comment:d};try{const e=await fetch("http://localhost:5000/api/reviews",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(a)}),s=await e.json();if(401===e.status)return o.oR.error("Please log in to submit a review."),void setTimeout((()=>{window.location.href="/login"}),1500);e.ok?(o.oR.success(s.message||"\u2705 Review submitted successfully!",{position:"top-right",autoClose:3e3,theme:"light"}),r(0),_(""),m(""),p(null)):o.oR.error(s.message||"\u274c Failed to submit review.")}catch(i){console.error("Error submitting review:",i),o.oR.error("\u274c An error occurred. Please try again.")}finally{R(!1)}},className:"review-form",children:[(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{children:"Select Service Category"}),(0,l.jsxs)("div",{className:"dropdown",children:[(0,l.jsxs)("div",{className:"dropdown-toggle form-control",onClick:()=>S(!w),children:[v?G[v]:"Select a category",(0,l.jsx)("span",{className:"dropdown-arrow",children:"\u25bc"})]}),w&&(0,l.jsx)("div",{className:"dropdown-menu",children:Object.entries(G).map((e=>{let[r,s]=e;return(0,l.jsx)("div",{className:"dropdown-item",onClick:()=>(u(r),p(null),S(!1),C(!0),void b("")),children:s},r)}))})]})]}),v&&(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{children:"Select Service Provider"}),(0,l.jsxs)("div",{className:"provider-search",children:[(0,l.jsx)("input",{type:"text",placeholder:"Search providers...",className:"form-control",value:f,onChange:e=>b(e.target.value),onFocus:()=>C(!0)}),y&&(0,l.jsx)("div",{className:"provider-list",children:j.length>0?j.map((e=>(0,l.jsxs)("div",{className:"provider-item",onClick:()=>(e=>{p(e),C(!1)})(e),children:[(0,l.jsx)("img",{src:e.image,alt:e.name,className:"provider-image1"}),(0,l.jsxs)("div",{className:"provider-info",children:[(0,l.jsx)("div",{className:"provider-name",children:e.name}),(0,l.jsxs)("div",{className:"provider-rating",children:[(0,l.jsx)(t.gt3,{color:"#f9b90b"}),(0,l.jsx)("span",{children:e.rating})]})]})]},e.id))):(0,l.jsx)("div",{className:"no-results",children:"No providers found"})})]}),h&&(0,l.jsxs)("div",{className:"selected-provider",children:[(0,l.jsxs)("div",{className:"selected-provider-content",children:[(0,l.jsx)("img",{src:h.image,alt:h.name,className:"selected-provider-image"}),(0,l.jsxs)("div",{className:"selected-provider-info",children:[(0,l.jsx)("h4",{children:h.name}),(0,l.jsxs)("div",{className:"provider-rating",children:[(0,l.jsx)(t.gt3,{color:"#f9b90b"}),(0,l.jsxs)("span",{children:[h.rating," (",h.views," reviews)"]})]})]})]}),(0,l.jsx)("button",{type:"button",className:"change-provider",onClick:()=>C(!0),children:"Change"})]})]}),(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{htmlFor:"reviewerName",children:"Your Name"}),(0,l.jsx)("input",{type:"text",id:"reviewerName",value:O,onChange:e=>_(e.target.value),className:"form-control",placeholder:"Enter your name",required:!0})]}),(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{children:"Your Rating"}),(0,l.jsxs)("div",{className:"rating",children:[(0,l.jsx)("p",{className:"rating-message",children:e>0?{1:"Not good",2:"Could\u2019ve been better",3:"OK",4:"Good",5:"Great!"}[e]:"Rate this provider"}),(0,l.jsx)("div",{className:"stars",children:[1,2,3,4,5].map((s=>{const a=n||e;let i="#e4e5e9";return s<=a&&(i=a<=2?"#ff4444":3===a?"#f4ec07":"#f9b90b"),(0,l.jsx)(t.gt3,{className:"star",color:i,size:32,onMouseEnter:()=>c(s),onMouseLeave:()=>c(0),onClick:()=>r(s),style:{cursor:"pointer",transition:"color 0.2s"}},s)}))})]})]}),(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{htmlFor:"review",children:"Your Review (min. 45 characters)"}),(0,l.jsx)("textarea",{id:"review",value:d,onChange:e=>m(e.target.value),className:"form-control",rows:"6",minLength:"45",required:!0,placeholder:"Share your experience with this service provider. Be specific about what you liked or didn't like."}),(0,l.jsxs)("div",{className:"character-count",children:[d.length,"/45 characters minimum"]})]}),(0,l.jsx)("button",{type:"submit",className:"submit-button",disabled:k,children:k?"Submitting...":"Submit Review"})]})]})]})}}}]);
//# sourceMappingURL=422.5b1e7f44.chunk.js.map